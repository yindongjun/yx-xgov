webpackJsonp([29],{"3t8C":function(t,e,a){"use strict";function i(t){a("J88Q")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("Hxrf"),r=a("QwtV"),n=a("VU/8"),l=i,o=n(s.a,r.a,!1,l,null,null);e.default=o.exports},GVTU:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,".report-template{height:calc(100% - 70px);padding:20px 30px;margin:45px 20px;margin-bottom:25px;background-color:#fff;-webkit-box-sizing:border-box;box-sizing:border-box}.report-template .el-scrollbar__wrap{overflow-x:hidden}.report-template .template-title{width:98%;background-color:#7e8ebf;padding:7px 0;padding-left:20px;font-size:14px;color:#fff;font-weight:400}.report-template .template-content{padding:30px 50px}.report-template .award .award-content .el-table{font-size:14px!important}.report-template .award .award-content .el-table .el-table__row{background:#fff!important}.report-template .award .award-content .el-table .hovered-row{background-color:#eaecf3!important}.report-template .award .award-content .el-table .edit-weight-input input{text-align:center;font-size:14px}.report-template .config .el-checkbox__input.is-checked+.el-checkbox__label{color:#606266!important}.report-template .config .el-checkbox__input.is-checked .el-checkbox__inner,.report-template .config .el-checkbox__input.is-indeterminate .el-checkbox__inner{background-color:#3ba3f8!important;border-color:#3ba3f8!important}.report-template .config .check-config{width:50%}.report-template .config .check-config .el-checkbox-group{overflow:hidden}.report-template .config .check-config .el-checkbox{margin:10px 0!important;float:left;width:50%}.report-template .submit{text-align:center;margin:20px 0}.award-standard-title{margin:0;padding:0;padding:10px 0;font-weight:400;font-size:15px}.award-standard{padding-left:30px}.award-standard-item{font-size:13px;padding:10px 0}.award-standard-ul{padding-left:20px}.award-standard-ul li{list-style:none;padding:5px 0}",""])},Hxrf:function(t,e,a){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}var s=a("byVz"),r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t};e.a={name:"report-template",components:{Slider:s.a},data:function(){return{grades:{},tableData:[],checkData:[],configs:[{id:1,label:"1. 综述"},{id:2,label:"2. 数据质量评分雷达图"},{id:3,label:"3. 标准数据占比总览"},{id:4,label:"4. 问题数据触发规则分布"},{id:5,label:"5. 问题数据处理进度"},{id:6,label:"6. 各表评分明细"}],isSetWeight:!1,rowIndex:"-1",OrderIndexArr:[],hoverOrderArr:[],gradesData:[]}},methods:{getData:function(){var t=this;this.$urlApi.dataQuality.showReportTemplte({templateId:"1"}).then(function(e){if(200==e.code){t.tableData=t.transferTableData(e.data.measureIndexs),t.getOrderNumber(),t.gradesData=e.data.grades;var a=e.data.grades.reverse().filter(function(t,e){return e<4}).map(function(t){return t.upperLimit});t.grades={value1:a[0],value2:a[1],value3:a[2]},t.checkData=e.data.exportModules.split(",").map(function(t){return+t}),localStorage.setItem("Rtemplate",JSON.stringify({tableData:t.tableData,grades:a,exportModules:t.checkData}))}})},setWeight:function(){if(!this.tableData.length)return this.$toast("error","无数据可以配置！");this.isSetWeight||(this.isSetWeight=!0,sessionStorage.setItem("reportTableData",JSON.stringify(this.tableData)))},saveSetWeight:function(){return this.$refs.tips?this.$toast("error","权重未配置正确，无法保存，请重新配置！"):this.isSetWeight?(this.isSetWeight=!1,sessionStorage.setItem("reportTableData",JSON.stringify(this.tableData)),this.$toast("success","权重配置成功！")):void 0},cancelSetWeight:function(){this.isSetWeight=!1,this.tableData=JSON.parse(sessionStorage.getItem("reportTableData"))},getAllWeight:function(t){var e=this.tableData.find(function(e){return e.id===t}).pMeasureIndex,a=this.tableData.filter(function(t){return t.pMeasureIndex===e}),i=0;return a.forEach(function(t){i+=Number.isNaN(+t.weight)||+t.weight<0?0:+t.weight}),i},submit:function(){var t=this;if(this.isSetWeight)return this.$toast("error","请先保存权重配置");var e=this.$refs.slider.getValue(),a=this.tableData.map(function(t){return{id:t.id,weight:t.weight,templateId:1}}),i=this,s={grades:JSON.stringify([{templateId:1,gradeName:"不合格",lowerLimit:0,id:i.gradesData.find(function(t){return"不合格"===t.gradeName}).id,upperLimit:e.value1},{templateId:1,gradeName:"合格",lowerLimit:e.value1,id:i.gradesData.find(function(t){return"合格"===t.gradeName}).id,upperLimit:e.value2},{templateId:1,gradeName:"良",lowerLimit:e.value2,id:i.gradesData.find(function(t){return"良"===t.gradeName}).id,upperLimit:e.value3},{templateId:1,gradeName:"优",id:i.gradesData.find(function(t){return"优"===t.gradeName}).id,lowerLimit:e.value3,upperLimit:100}]),measureIndexs:JSON.stringify(a),exportModules:this.checkData.join(",")};this.$urlApi.dataQuality.addReportTemplte(s).then(function(e){200==e.code&&(t.$toast("success","模板保存成功"),t.getData())}).catch(function(e){t.$toast("error","模板保存失败"),t.getData()})},objectSpanMethod:function(t){var e=t.row,a=(t.column,t.rowIndex),i=t.columnIndex;if(0===i||1===i){var s={};this.tableData.forEach(function(t,e){s[t.pMeasureIndex]?s[t.pMeasureIndex].push(e):s[t.pMeasureIndex]=[e]});var r=Object.keys(s).find(function(t){return t===e.pMeasureIndex});return r&&a===s[r][0]?{rowspan:s[r].length,colspan:1}:{rowspan:0,colspan:0}}},transferTableData:function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"children",a=[];return function t(i){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.forEach(function(i){i[e]?t(i[e],{pWeight:i.weight,pMeasureIndex:i.measureIndex}):a.push(r({},i,s))})}(t),a.map(function(t){return t[e]&&delete t[e],t})}(t)},changeSetWeight:function(t,e){var a=this.tableData.findIndex(function(e){return e.id===t});if(-1!=a){var s=[].concat(i(this.tableData));s[a].weight=Number.isNaN(parseInt(e))||parseInt(e)<0?0:parseInt(e),this.tableData=s}},cellMouseEnter:function(t,e,a,i){var s=this;this.rowIndex=t.rowIndex,this.hoverOrderArr=[],this.OrderIndexArr.forEach(function(t){t.indexOf(s.rowIndex)>=0&&(s.hoverOrderArr=t)})},cellMouseLeave:function(t,e,a,i){this.rowIndex="-1",this.hoverOrderArr=[]},tableRowClassName:function(t){for(var e=(t.row,t.rowIndex),a=this.hoverOrderArr,i=0;i<a.length;i++)if(e==a[i])return"hovered-row"},getOrderNumber:function(){var t={};this.tableData.forEach(function(e,a){e.rowIndex=a,t[e.pMeasureIndex]?t[e.pMeasureIndex].push(a):t[e.pMeasureIndex]=[a]});for(var e in t)t[e].length>1&&this.OrderIndexArr.push(t[e])},resetTemplate:function(){var t=this,e=JSON.parse(localStorage.getItem("Rtemplate"));this.tableData=e.tableData,this.grades={},this.$nextTick(function(){t.grades={value1:e.grades[0],value2:e.grades[1],value3:e.grades[2]}}),this.checkData=e.exportModules,this.$toast("success","报告模板已经重置")}},mounted:function(){this.getData()}}},J88Q:function(t,e,a){var i=a("GVTU");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("845b9f5c",i,!0,{})},PUZB:function(t,e,a){"use strict";var i=a("7t+N"),s=a.n(i);e.a={name:"slider",props:["grades"],data:function(){return{value1:"",value2:"",value3:""}},methods:{init:function(){var t=this,e=parseFloat(s()(".main").css("width")),a=function(t){return t/100*e};s()(".op1").css({width:a(this.$props.grades.value1)}),s()(".op2").css({width:a(this.$props.grades.value2-this.$props.grades.value1)}),s()(".op3").css({width:a(this.$props.grades.value3-this.$props.grades.value2)}),s()(".op4").css({width:a(100-this.$props.grades.value3)}),t.value1=this.$props.grades.value1,t.value2=this.$props.grades.value2-this.$props.grades.value1,t.value3=this.$props.grades.value3-this.$props.grades.value2;var i={handle1:!1,startX1:"",width1:""},r={handle2:!1,startX2:"",width2:""},n={handle3:!1,startX3:"",width3:""},l={handle4:!1,startX4:"",width4:""};s()(".c1").mousedown(function(t){i.handle1=!0,i.startX1=t.pageX,i.width1=parseFloat(s()(".op1").css("width")),r.width2=parseFloat(s()(".op2").css("width"))}),s()(document).mouseup(function(t){i.handle1=!1}),s()(document).mousemove(function(a){if(i.handle1){var n,l,o=i.startX1-a.pageX;o>0&&i.width1-o<=8?(n=8,l=i.width1+r.width2-8,s()(".op1").css({width:n}),s()(".op2").css({width:l}),t.value1=(n-8)/e*100,t.value2=(l+8)/e*100):o<0&&r.width2-Math.abs(o)<=8?(n=i.width1+r.width2-8,l=8,s()(".op1").css({width:n}),s()(".op2").css({width:l}),t.value1=(n+8)/e*100,t.value2=(l-8)/e*100):(n=i.width1-o,l=r.width2+o,s()(".op1").css({width:n}),s()(".op2").css({width:l}),t.value1=n/e*100,t.value2=l/e*100)}}),s()(".c2").mousedown(function(t){r.handle2=!0,r.startX2=t.pageX,r.width2=parseFloat(s()(".op2").css("width")),n.width3=parseFloat(s()(".op3").css("width"))}),s()(document).mouseup(function(t){r.handle2=!1}),s()(document).mousemove(function(a){if(r.handle2){var i,l,o=r.startX2-a.pageX;o>0&&r.width2-o<=8?(i=8,l=r.width2+n.width3-8,s()(".op2").css({width:i}),s()(".op3").css({width:l}),t.value2=(i-8)/e*100,t.value3=(l+8)/e*100):o<0&&n.width3-Math.abs(o)<=8?(i=r.width2+n.width3-8,l=8,s()(".op2").css({width:i}),s()(".op3").css({width:l}),t.value2=(i+8)/e*100,t.value3=(l-8)/e*100):(i=r.width2-o,l=n.width3+o,s()(".op2").css({width:i}),s()(".op3").css({width:l}),t.value2=i/e*100,t.value3=l/e*100)}}),s()(".c3").mousedown(function(t){n.handle3=!0,n.startX3=t.pageX,n.width3=parseFloat(s()(".op3").css("width")),l.width4=parseFloat(s()(".op4").css("width"))}),s()(document).mouseup(function(t){n.handle3=!1}),s()(document).mousemove(function(a){if(n.handle3){var i,r,o=n.startX3-a.pageX;o>0&&n.width3-o<=8?(i=8,r=n.width3+l.width4-8,s()(".op3").css({width:i}),s()(".op4").css({width:r}),t.value3=(i-8)/e*100):o<0&&l.width4-Math.abs(o)<=8?(i=n.width3+l.width4,r=0,s()(".op3").css({width:i}),s()(".op4").css({width:r}),t.value3=i/e*100):(i=n.width3-o,r=l.width4+o,s()(".op3").css({width:i}),s()(".op4").css({width:r}),t.value3=i/e*100)}})},getValue:function(){return{value1:this.value.value1,value2:this.value.value2,value3:this.value.value3,value4:this.value.value4}}},computed:{value:function(){return{value1:Math.round(this.value1),value2:Math.round(this.value1+this.value2),value3:Math.round(this.value1+this.value2+this.value3),value4:100}}},mounted:function(){this.init()}}},QwtV:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"report-template"},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("div",{staticClass:"degree"},[a("h2",{staticClass:"template-title"},[t._v("评分等级")]),t._v(" "),a("div",{staticClass:"degree-content template-content"},[Object.keys(Object.assign({},this.grades)).length?a("Slider",{ref:"slider",attrs:{grades:t.grades}}):t._e()],1)]),t._v(" "),a("div",{staticClass:"award"},[a("h2",{staticClass:"template-title"},[t._v("\n        评分模板     \n        "),a("el-popover",{attrs:{placement:"right-start",trigger:"hover"}},[a("div",{staticClass:"award-standard"},[a("h5",{staticClass:"award-standard-title"},[t._v("打分规则")]),t._v(" "),a("div",{staticClass:"award-standard-item"},[t._v("\n              1.每项总默认权重不可调整，规则权重可以依据实际情况调整权重分值。\n            ")]),t._v(" "),a("div",{staticClass:"award-standard-item"},[t._v("2.打分要求：")]),t._v(" "),a("ul",{staticClass:"award-standard-ul"},[a("li",[t._v("1）问题数据占比低于10%则不扣分")]),t._v(" "),a("li",[t._v("2）问题数据占比10%-25%则扣1分")]),t._v(" "),a("li",[t._v("3）问题数据占比25%-40%则扣3分")]),t._v(" "),a("li",[t._v("4）问题数据占比高于40%则不得分")])]),t._v(" "),a("div",{staticClass:"award-standard-item"},[t._v("\n              占比计算公式 = 问题数据字段数 / 总校验数据字段数\n            ")]),t._v(" "),a("div",{staticClass:"award-standard-item"},[t._v("3.修正分：")]),t._v(" "),a("ul",{staticClass:"award-standard-ul"},[a("li",[t._v("\n                1）如校验数据不包含该规则，为不影响整体评分，该检查项赋予满分\n              ")]),t._v(" "),a("li",[t._v("\n                2）同一条问题数据同时触发多次校验规则，按照各自的扣分项分别记录\n              ")])])]),t._v(" "),a("span",{staticClass:"cell",attrs:{slot:"reference"},slot:"reference"},[a("svg-icon",{attrs:{iconClass:"help-circle"}})],1)])],1),t._v(" "),a("div",{staticClass:"award-content template-content"},[a("el-button",{staticClass:"grey-btn",attrs:{disabled:t.isSetWeight,size:"mini"},on:{click:t.setWeight}},[t._v("配置权重")]),t._v(" "),t.isSetWeight?a("el-button",{staticClass:"red-btn",attrs:{size:"mini"},on:{click:t.saveSetWeight}},[t._v("保存配置")]):t._e(),t._v(" "),t.isSetWeight?a("el-button",{staticClass:"red-btn",attrs:{size:"mini"},on:{click:t.cancelSetWeight}},[t._v("取消配置")]):t._e(),t._v(" "),a("div",{staticStyle:{"margin-top":"20px"}}),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.tableData,"span-method":t.objectSpanMethod,"cell-class-name":t.tableRowClassName},on:{"cell-mouse-leave":t.cellMouseLeave,"cell-mouse-enter":t.cellMouseEnter}},[a("el-table-column",{attrs:{align:"center",prop:"pMeasureIndex",label:"评分标准"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"pWeight",label:"默认权重"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"measureIndex",label:"校验规则"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"规则权重"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.isSetWeight?a("el-input",{staticClass:"edit-weight-input",staticStyle:{width:"50%"},on:{change:function(a){return t.changeSetWeight(e.row.id,a)}},model:{value:e.row.weight,callback:function(a){t.$set(e.row,"weight",a)},expression:"scope.row.weight"}}):a("span",[t._v(t._s(e.row.weight))]),t._v(" "),a("br"),t._v(" "),e.row.pWeight!=t.getAllWeight(e.row.id)?a("span",{ref:"tips",staticStyle:{color:"red","font-size":"12px"}},[t._v("默认总权重为"+t._s(e.row.pWeight)+"， 当前总权重值为"+t._s(t.getAllWeight(e.row.id)))]):t._e()]}}])})],1)],1)]),t._v(" "),a("div",{staticClass:"config"},[a("h2",{staticClass:"template-title"},[t._v("报表导出配置")]),t._v(" "),a("div",{staticClass:"config-content template-content"},[a("div",{staticStyle:{margin:"15px 0"}}),t._v(" "),a("div",{staticClass:"check-config"},[a("el-checkbox-group",{model:{value:t.checkData,callback:function(e){t.checkData=e},expression:"checkData"}},t._l(t.configs,function(e){return a("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.label))])}),1)],1)])]),t._v(" "),a("div",{staticClass:"submit"},[a("el-button",{attrs:{type:"info",size:"small"},on:{click:t.resetTemplate}},[t._v("重置")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.submit}},[t._v("保存")])],1)])],1)},s=[],r={render:i,staticRenderFns:s};e.a=r},"YS/D":function(t,e,a){var i=a("rXk0");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("8e199588",i,!0,{})},byVz:function(t,e,a){"use strict";function i(t){a("YS/D")}var s=a("PUZB"),r=a("inAh"),n=a("VU/8"),l=i,o=n(s.a,r.a,!1,l,null,null);e.a=o.exports},inAh:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"slider"},[t._m(0),t._v(" "),a("div",{staticClass:"sample"},[a("div",{staticClass:"sp1 sp"},[a("div",{staticClass:"f1 ff"}),t._v(" "),a("div",{staticClass:"txt1 txt"},[t._v("不合格")]),t._v(" "),a("div",{staticClass:"value1 valueShow"},[t._v(t._s("0 ~ "+(t.value.value1-1)))])]),t._v(" "),a("div",{staticClass:"sp2 sp"},[a("div",{staticClass:"f2 ff"}),t._v(" "),a("div",{staticClass:"txt2 txt"},[t._v("合格")]),t._v(" "),a("div",{staticClass:"value2 valueShow"},[t._v("\n        "+t._s(t.value.value1+" ~ "+(t.value.value2-1))+"\n      ")])]),t._v(" "),a("div",{staticClass:"sp3 sp"},[a("div",{staticClass:"f3 ff"}),t._v(" "),a("div",{staticClass:"txt3 txt"},[t._v("良")]),t._v(" "),a("div",{staticClass:"value3 valueShow"},[t._v("\n        "+t._s(t.value.value2+" ~ "+(t.value.value3-1))+"\n      ")])]),t._v(" "),a("div",{staticClass:"sp4 sp"},[a("div",{staticClass:"f4 ff"}),t._v(" "),a("div",{staticClass:"txt4 txt"},[t._v("优")]),t._v(" "),a("div",{staticClass:"value4 valueShow"},[t._v(t._s(t.value.value3+" ~ 100"))])])])])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("div",{staticClass:"op1 op"},[a("div",{staticClass:"c c1"})]),t._v(" "),a("div",{staticClass:"op2 op"},[a("div",{staticClass:"c c2"})]),t._v(" "),a("div",{staticClass:"op3 op"},[a("div",{staticClass:"c c3"})]),t._v(" "),a("div",{staticClass:"op4 op"})])}],r={render:i,staticRenderFns:s};e.a=r},rXk0:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,'.slider{width:100%}.slider .main{width:800px;height:10px;background-color:#ddd;position:relative}.slider .main:before{left:0;background-color:#f26565}.slider .main:after,.slider .main:before{position:absolute;content:"";width:2px;height:30px;top:-10px}.slider .main:after{right:0;background-color:#8ddecc}.slider .main .op{position:relative;float:left;height:100%}.slider .main .op1{background-color:#f26565}.slider .main .op1 .c1{background:-webkit-gradient(linear,left top,right top,from(#f26565),to(#f59a78));background:linear-gradient(90deg,#f26565,#f59a78);position:absolute;right:0;top:-10px}.slider .main .op2{background-color:#f59a78}.slider .main .op2 .c2{background:-webkit-gradient(linear,left top,right top,from(#f59a78),to(#f8e287));background:linear-gradient(90deg,#f59a78,#f8e287);position:absolute;right:0;top:-10px}.slider .main .op3{background-color:#f8e287}.slider .main .op3 .c3{background:-webkit-gradient(linear,left top,right top,from(#f8e287),to(#8ddecc));background:linear-gradient(90deg,#f8e287,#8ddecc);background-color:#f8e287;position:absolute;right:0;top:-10px}.slider .main .op4{background-color:#8ddecc}.slider .main .c{width:8px;height:30px;cursor:-webkit-grab;cursor:grab;border-radius:2px}.slider .sample{margin-top:30px;overflow:hidden}.slider .sample .sp{overflow:hidden;padding:5px 0;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;width:25%}.slider .sample .ff{float:left;width:40px;height:20px;border-radius:4px;margin-top:10px}.slider .sample .txt,.slider .sample .valueShow{float:left;margin-left:10px;font-size:14px;color:#606266;line-height:40px}.slider .sample .f1{background-color:#f26565}.slider .sample .f2{background-color:#f59a78}.slider .sample .f3{background-color:#f8e287}.slider .sample .f4{background-color:#8ddecc}',""])}});