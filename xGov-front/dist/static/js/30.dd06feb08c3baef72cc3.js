webpackJsonp([30],{"+0El":function(t,e,a){"use strict";var n=a("9A18"),s=a("6kY+"),o=a("VU/8"),i=o(n.a,s.a,!1,null,null,null);e.a=i.exports},"0aTm":function(t,e,a){"use strict";function n(t){a("O91+")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("5nCA"),o=a("1zii"),i=a("VU/8"),l=n,r=i(s.a,o.a,!1,l,null,null);e.default=r.exports},"1zii":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"task-monitor-section main-outer"},[a("el-row",{staticClass:"common-condition ar mb15"}),t._v(" "),t.homeList?a("el-row",{staticClass:"main-inner"},[a("div",{staticClass:"search_list"},[a("el-row",[a("el-col",{attrs:{span:24}},[a("span",{staticClass:"search_title"},[t._v("运行状态:")]),t._v(" "),a("el-radio-group",{attrs:{size:"small"},on:{change:t.changeStatus},model:{value:t.applicationStatus,callback:function(e){t.applicationStatus=e},expression:"applicationStatus"}},[a("el-radio-button",{attrs:{label:""}},[t._v("全部")]),t._v(" "),a("el-radio-button",{attrs:{label:"0"}},[t._v("执行中")]),t._v(" "),a("el-radio-button",{attrs:{label:"1"}},[t._v("成功")]),t._v(" "),a("el-radio-button",{attrs:{label:"2"}},[t._v("失败")])],1),t._v(" "),a("div",{staticStyle:{float:"right"}},[a("el-input",{staticStyle:{width:"330px"},attrs:{placeholder:"请输入任务名称进行查询",size:"mini"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeStatus(e)}},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:t.changeStatus}},[t._v("查询")])],1)],1)],1)],1),t._v(" "),a("el-row",{staticClass:"mt20 task-monitor-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"100%"}},[a("template",{slot:"empty"},[a("div",{staticClass:"show-empty"},[t._v("\n            暂无任务执行数据\n          ")])]),t._v(" "),a("el-table-column",{attrs:{prop:"taskName",label:"任务名称","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"任务类型","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.taskType?a("span",[t._v("采集任务")]):a("span",[t._v("质量任务")])]}}],null,!1,4142408607)}),t._v(" "),a("el-table-column",{attrs:{label:"最新运行状态","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("el-tag",{staticClass:"success-tag"},[t._v("成功")]):t._e(),t._v(" "),2==e.row.status?a("el-tag",{staticClass:"error-tag"},[t._v("失败")]):t._e(),t._v(" "),0==e.row.status?a("el-tag",{staticClass:"going-tag"},[t._v("执行中")]):t._e()]}}],null,!1,3863239550)}),t._v(" "),a("el-table-column",{attrs:{label:"调度方式","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.cycleType?a("span",[t._v("单次")]):a("span",[t._v("周期性")])]}}],null,!1,591453600)}),t._v(" "),a("el-table-column",{attrs:{prop:"startTime",label:"最新执行时间","show-overflow-tooltip":"",formatter:this.$utils.dateFormat}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"operate-btn",attrs:{type:"text"},on:{click:function(a){return t.showDetail(e.row.taskId)}}},[t._v("执行历史")])]}}],null,!1,2869561055)})],2),t._v(" "),a("el-pagination",{staticClass:"ar mt15",attrs:{"current-page":t.currentPage,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1):a("el-row",{staticClass:"main-inner"},[a("span",{staticStyle:{cursor:"pointer"},on:{click:t.backHome}},[a("i",{staticClass:"el-icon-arrow-left"}),t._v(" 任务监控列表")]),t._v(" "),a("el-row",{staticClass:"mt20 task-monitor-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableDataHis,height:"100%"}},[a("template",{slot:"empty"},[a("div",{staticClass:"show-empty"},[t._v("\n            暂无历史数据\n          ")])]),t._v(" "),a("el-table-column",{attrs:{prop:"startTime",label:"执行时间","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"执行状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("el-tag",{staticClass:"success-tag"},[t._v("成功")]):t._e(),t._v(" "),2==e.row.status?a("el-tag",{staticClass:"error-tag"},[t._v("失败")]):t._e(),t._v(" "),0==e.row.status?a("el-tag",{staticClass:"going-tag"},[t._v("执行中")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"spent",label:"执行时长(s)","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("span",[t._v(t._s(e.row.spent))]):a("span",[t._v("/")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"operate-btn",attrs:{type:"text"},on:{click:function(a){return t.showLog(e.row.id)}}},[t._v("日志")])]}}])})],2),t._v(" "),a("el-pagination",{staticClass:"ar mt15",attrs:{"current-page":t.currentPage1,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:t.total1},on:{"size-change":t.handleSizeChange1,"current-change":t.handleCurrentChange1}})],1)],1),t._v(" "),a("history-info",{attrs:{historyInfoVisible:t.historyInfoVisible,taskID:t.taskID,logsId:t.logsId},on:{historyInfoBack:t.historyInfoBack}})],1)},s=[],o={render:n,staticRenderFns:s};e.a=o},"5nCA":function(t,e,a){"use strict";var n=a("+0El"),s=a("treS");a.n(s);e.a={name:"task-monitor",components:{HistoryInfo:n.a},data:function(){return{total:0,currentPage:1,pageLength:10,total1:0,currentPage1:1,pageLength1:10,deleteSelection:[],applicationStatus:"",taskType:"",tableData:[],searchName:"",taskID:"",historyInfoVisible:!1,homeList:!0,tableDataHis:[],logsId:""}},methods:{getList:function(t){var e=this;t&&(this.currentPage=t);var a={start:(this.currentPage-1)*this.pageLength,length:this.pageLength,taskType:this.taskType,status:this.applicationStatus,taskName:this.searchName};this.$urlApi.dispatchTask.monitorList(a).then(function(t){e.tableData=t.data,e.total=t.recordsFiltered})},handleSizeChange:function(t){this.pageLength=t,this.getList(1)},handleCurrentChange:function(t){this.currentPage=t,this.getList()},handleSizeChange1:function(t){this.pageLength1=t,this.getHistoryList(this.taskID)},handleCurrentChange1:function(t){this.currentPage1=t,this.getHistoryList(this.taskID)},changeFun:function(t){this.deleteSelection=t},changeStatus:function(t){this.getList(1)},changeType:function(t){this.getList(1)},getHistoryList:function(t){var e=this;return new Promise(function(a,n){var o={start:(e.currentPage1-1)*e.pageLength1,length:e.pageLength1,taskId:t};e.$urlApi.dispatchTask.getMonitorHistories(o).then(function(t){e.tableDataHis=t.data.map(function(t){return t.startTime=Object(s.changeUTCtoDateTime)("yyyy-MM-dd HH:mm:ss",t.startTime),t.endTime=Object(s.changeUTCtoDateTime)("yyyy-MM-dd HH:mm:ss",t.endTime),t}),e.total1=t.recordsFiltered,a()})})},showDetail:function(t){var e=this;this.taskID=t,this.getHistoryList(t).then(function(){e.homeList=!1})},backHome:function(){this.homeList=!0,this.tableDataHis=[],this.total1=0,this.currentPage1=1,this.pageLength1=10},showLog:function(t){this.logsId=t,this.historyInfoVisible=!0},historyInfoBack:function(){this.historyInfoVisible=!1}},mounted:function(){this.getList()}}},"6kY+":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"quality-task-info",attrs:{title:"执行历史",visible:t.historyInfoVisible,"before-close":t.closeDialog,"lock-scroll":!1,width:"760px","close-on-click-modal":!1},on:{"update:visible":function(e){t.historyInfoVisible=e},open:t.open}},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.getLogsByName},model:{value:t.tableID,callback:function(e){t.tableID=e},expression:"tableID"}},t._l(t.tableList,function(e,n){return a("el-tab-pane",{key:n,attrs:{label:e.tableName,name:e.id}},[a("ul",{staticStyle:{"font-family":"consolas","line-height":"1.5","font-size":"13px"}},t._l(t.contentData,function(e){return a("li",{key:e.id},[a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(e.createTime))]),t._v(" "),a("span",[t._v(t._s(e.logDetail))])])}),0)])}),1)],1)},s=[],o={render:n,staticRenderFns:s};e.a=o},"9A18":function(t,e,a){"use strict";var n=a("treS");a.n(n);e.a={name:"historyInfo",props:["historyInfoVisible","taskID","logsId"],data:function(){return{tableID:"",tableList:[],contentData:[]}},methods:{open:function(){this.getTaskTable(this.taskID)},getHistoryById:function(t){var e=this;this.$urlApi.dispatchTask.getLogsByTable({taskHisId:t.id,tableName:t.name}).then(function(t){e.contentData=t.data.map(function(t){return t.createTime=Object(n.changeUTCtoDateTime)("yyyy-MM-dd HH:mm:ss",t.createTime),t})})},getTaskTable:function(t){var e=this;this.$urlApi.dataQuality.getTaskTables({taskId:t}).then(function(t){"200"===t.code&&(t.data.length&&(e.tableID=t.data[0].id.toString(),e.getHistoryById({id:e.$props.logsId,name:t.data[0].tableName})),e.tableList=t.data.map(function(t){return t.id=t.id.toString(),t}))})},getLogsByName:function(t){this.contentData=[];var e={id:this.$props.logsId,name:t.label};this.getHistoryById(e)},closeDialog:function(){this.$emit("historyInfoBack"),this.contentData=[],this.tableID="",this.tableList=[]}}}},"O91+":function(t,e,a){var n=a("s0je");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("83bfc6e2",n,!0,{})},s0je:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,".task-monitor-section{height:100%}.task-monitor-section .main-inner{height:calc(100% - 35px)}.task-monitor-section .main-inner .task-monitor-content{height:calc(100% - 125px)}.task-monitor-section .main-inner .task-monitor-content .el-table__empty-block{-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline}.task-monitor-section .main-inner .task-monitor-content .el-table__empty-block .show-empty{margin-top:20px}.task-monitor-section .search_list{margin-top:10px}.task-monitor-section .search_list .search_title{display:inline-block;width:60px;text-align:right;margin-right:10px}.task-monitor-section .search_list .el-radio-button__inner{border:0}.task-monitor-section .search_list .el-radio-button__orig-radio:checked+.el-radio-button__inner{color:#3ba3f8;border:0;background:transparent;-webkit-box-shadow:none;-o-box-shadow:none;box-shadow:none}",""])},treS:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.changeUTCtoDateTime=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:+new Date;if(!t)return"";var a=e;(e instanceof Date||"string"==typeof e)&&(a=+e);var n=new Date(a),s=n.getFullYear(),o=n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1,i=n.getDate()<10?"0"+n.getDate():n.getDate(),l=n.getHours()<10?"0"+n.getHours():n.getHours(),r=n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes(),c=n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds();return"yyyy-MM-dd HH:mm:ss"===t?s+"-"+o+"-"+i+" "+l+":"+r+":"+c:"yyyy-MM-dd"===t?s+"-"+o+"-"+i:""},e.checkType=function(t){return{"[object Number]":"number","[object String]":"string","[object Boolean]":"boolean","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object","[object Array]":"array","[object Symbol]":"symbol","[object Date]":"date","[object Error]":"error","[object RegExp]":"regExp","[object Function]":"function","[object Math]":"math","[object JSON]":"json","[object Arguments]":"arguments"}[Object.prototype.toString.call(t)]}}});